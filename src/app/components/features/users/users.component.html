<section class="users">
  <div class="header">
    <h2 class="title">
      <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5C15 14.17 10.33 13 8 13zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"></path>
      </svg>
      <span>Usuarios</span>
      <span class="data-source" *ngIf="showApiData">(Datos de API)</span>
    </h2>
    <div class="button-group">
      <button class="btn secondary" (click)="loadUsersFromApi()" [disabled]="showApiData">Cargar desde API</button>
      <button class="btn secondary" (click)="showMockData()" *ngIf="showApiData">Ver Datos Mock</button>
    </div>
  </div>
  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Email</th>
          <th>Rol</th>
          <th>Estado</th>
          <th>Ãšltimo Acceso</th>
          <th>Creado</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <!-- Datos Mock -->
        <ng-container *ngIf="!showApiData">
          <tr *ngFor="let u of users">
            <td>{{ u.name }}</td>
            <td class="muted">{{ u.email }}</td>
            <td>
              <span class="badge" [class.badge-admin]="u.role==='admin'" [class.badge-editor]="u.role==='editor'" [class.badge-viewer]="u.role==='viewer'">{{ u.role }}</span>
            </td>
            <td>
              <span class="status" [class.online]="u.status==='activo'" [class.offline]="u.status==='inactivo'">{{ u.status }}</span>
            </td>
            <td class="muted">{{ u.lastAccess }}</td>
            <td class="muted">{{ u.createdAt }}</td>
            <td class="actions">
              <button class="btn primary">Ver</button>
            </td>
          </tr>
        </ng-container>
        
        <!-- Datos de la API -->
        <ng-container *ngIf="showApiData">
          <tr *ngFor="let u of apiUsers">
            <td>{{ u.name }}</td>
            <td class="muted">{{ u.email }}</td>
            <td>
              <span class="badge badge-api">{{ u.profile?.name || 'Sin perfil' }}</span>
            </td>
            <td>
              <span class="status online">Activo</span>
            </td>
            <td class="muted">{{ u.updated_at | date:'short' }}</td>
            <td class="muted">{{ u.created_at | date:'short' }}</td>
            <td class="actions">
              <button class="btn primary">Ver</button>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</section>
